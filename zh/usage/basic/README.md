# 基础模块

## 序列 LOGO

- 简介

  序列logo是一种用来描述结合位点序列模式的图形。

- 案例数据分析

  **载入数据为多个转录因子在多个基因上的结合位点的序列**。

- 案例统计图形解读

  采用bits计算的方式将一个结合位点序列展示在图表一列，可以清晰观测到不同序列占比较大的碱基。

- 特殊参数

  序列类型：dna表示DNA序列，rna表示RNA序列，aa表示氨基酸序列。

  序列颜色：不同碱基颜色。

  方式类型：bits表示采用bits公式展示不同碱基在最大值为2的纵坐标轴中的占比；prob表示碱基占序列总体碱基的比例，并按占比展示在最大值为1的纵坐标轴中。

## 热图

- 简介

  热图是对实验数据分布情况进行分析的直观可视化方法，可以用来进行实验数据的质量控制和差异数据的具象化展示，还可以对数据和样品进行聚类分析，观测样品质量。

- 案例数据分析

  载入数据为count (基因名称及其对应的基因表达值)，样本信息（样本名称，所属组群及其他相关信息，如年龄），基因信息（基因名称及其所属通路，如肿瘤通路和生理状况下通路）

- 案例统计图形解读

  示例图每个小格表示每个基因，颜色深浅表示该基因表达量大小，表达量越大颜色越深（红色为上调，绿色为下调）。每行表示每个基因在不同样本中的表达量状况，每列表示每个样本所有基因的表达量情况。上方树形图表示不同组群和年龄的不同样本的聚类分析结果，左侧树形图表示来自不同样本的不同基因的聚类分析结果。

- 特殊参数

  热图颜色：更改热图的颜色

## 相关性热图

- 简介

  相关性热图是一种分析多个变量，两两之间相关性的图形。

- 案例数据分析

  载入数据为基因名称及每个样本的表达量。

- 案例统计图形分析

  红色系表示两个基因之间呈正相关，蓝色系表示两个基因之间呈负相关，每一格中的数字表示相关系数。
  
- 特殊参数

  相关性计算（行/列）：row表示按照行进行相关性计算，col表示按照列进行相关性计算。

  选择展示部分：upper表示显示左上角图形，lower表示显示右下角图形，full表示显示全景图片。

  形状：circle表示每个格子内的图形是圆圈，square表示每个格子内的图形是正方形。

  排序：按照得到的相关性系数进行排序。

## ROC 曲线

- 简介

  接收者工作特征曲线（ROC曲线）是用来说明二元分类器系统在其识别阈值变化时诊断能力的图形。

- 案例数据分析

  示例数据为一列二分类变量的结局和三列不同变量（诊断指标）及其数值。

- 案例统计图形解读

  横轴表示特异性，纵轴表示敏感性，二者之间没有函数关系。曲线越靠近左上角，认为该诊断指标预测能力越好。图示中每种颜色表示一个变量（诊断指标），蓝色曲线和红色曲线的预测能力明显较绿色曲线好。AUC为ROC曲线下面积。AUC=1表示该曲线存在至少一个阈值能得出完美预测。0.5<AUC<1，优于随机猜测，妥善选择阈值，能有预测价值。AUC=0.5，跟随机猜测一样，模型没有预测价值。若AUC<0.5，可能原因是二分类变量如（0，1）与结局设置颠倒，调换结局赋值即可。在本图示中，value-Am (86.9792) > value-GG (84.3750) > value-EL (56.7708)，可以认为Am变量的预测能力最好。

- 特殊参数

  置信区间：shape表示画一个有颜色区域的置信区间，bars表示画一个由竖条构成的置信区间，no表示不绘制置信区间。

  绘制平滑的ROC曲线：使呈阶梯样图变成一条圆滑的曲线。

  进行模型评估：**未知**

  进行模型比较：**未知**

## 箱式图

- 简介

  箱形图是一种通过四分位数图形象化地描述一组数据分布特征的方法。

- 案例数据分析

  载入数据为数据集(不同治疗方案的治疗效果数据)。

- 案例统计图形分析

  横坐标表示几组不同的数据，纵坐标分别表示各组数据的四分位数；即方框上、中、下的横线分别代表上四分位数，中位数，下四分位数；上下方线段代表的数值分别指数据最大值和最小值，方框以外的点代表离群值。图示上方数值表示两两变量间的p值，可认为治疗方案1中，中剂量组同低剂量组疗效有显著差异，以此类推。

- 特殊参数

  p值展示形式：value表示数值，signif表示 "\*" 的数量，no表示不展示p值

  添加散点：将数值表示的点标明出来

## 小提琴图

- 简介

  小提琴图，因形似小提琴而得名，是结合了箱形图和核密度图，用于显示数据分布及概率密度的统计图表。

- 案例数据分析

  载入数据为数据集(不同肿瘤中基因名称及表达水平)。

- 案例统计图形分析

  小提琴图可以反映数据分布，同箱形图类似，方框中黑色横线显示各肿瘤中基因表达水平的中位数， 白色方框中上下框边代表数据集中的上，下四分位点；小提琴图还可以反映数据密度，数据集数据越集中则图形越胖。图示中BLGG 组中的基因表达分布更集中，BIC 组次之，AML组则分布最分散。

- 特殊参数

  p值展示形式：value表示数值，signif表示"\*" 的数量，no表示不展示p值

  添加箱线图：在小提琴内部放置一个箱线图

## 半小提琴图

- 简介

  半小提琴图是在保留小提琴图右半部分图形的基础上，将左侧部分换成数据频次计数图形，也是用于显示数据分布及概率密度的统计图表。

- 案例数据分析

  载入数据为载入数据为数据集(不同肿瘤中基因名称及表达水平)。

- 案例统计图形分析

  半小提琴图可以反映数据分布，同箱形图类似，方框中黑色横线显示各肿瘤中基因表达水平的中位数， 白色方框中上下框边代表数据集中的上，下四分位点；左半面可观测数值点的分布状况；小提琴图还可以反映数据密度，数据集数据越集中则图形越胖。图示中BLGG 组中的基因表达分布更集中，BIC 组次之，AML组则分布最分散。

## 岭图

- 简介

  岭图是一种将点连接围成形似山岭的图形。

- 案例数据分析

  载入数据为三种分组及其对应的数值。

- 案例统计图形分析

  不同颜色表示不同分组，可以观测数据大致的高低程度。

## 甘特图

- 简介

  甘特图是一种用来说明项目进度条形图。

- 案例数据分析

  载入数据为4个样本即四位患者，3个项目即3种治疗方法，以及每种治疗方法的起止时间。

- 案例统计图形解读

  横轴表示时间进度，纵轴表示4位患者，3种颜色表示3种治疗方法，该图可以观测到每位患者不同治疗方法使用的时间进度。

## 生存曲线

- 简介

  生存曲线是显示特定物种或群体(如雄性或雌性)在每个年龄存活下来的个体数量或比例的图表。

- 案例数据分析

  载入数据为时间点，生存状态及分组。

- 案例统计图形解读

  横轴表示时间轴，纵轴表示生存概率。红色曲线表示G1组生存曲线，蓝色曲线表示G2组生存曲线。经过logrank检验后发现p值=0.0013<0.05，表明两组患者生存状况的差异不能用抽样误差来解释，分组因素才是导致两条曲线生存率出现差异的原因。该示例图形表明，G2组的总体生存率要好于G1组。

## 火山图

- 简介

  火山图是一种直观展示两个样本间基因差异表达的分布图。

- 案例数据分析

  载入数据为基因名称及其对应的logFC和p.value。

- 案例统计图形解读

  横轴用log2（fold change）表示，差异越大的基因分布在图片两端。纵坐标用-log10（p.value）表示，取值为T检验显著性p值的负对数。蓝色的点代表下调的基因，红色的点代表上调的基因，灰色的点代表差异不显著的基因。

- 特殊参数

  P值阈值：更改横向虚线轴

  Log2FoldChange阈值：更改纵向虚线轴

  展示Top基因：标注上调或者下调的基因名称

## 桑基图

- 简介

  桑基图是一种流量图，其中箭头的宽度与流量成比例。

- 案例数据分析

  载入数据为4个变量及每4种变量组合下的频数。

- 案例统计图形解读

  female分流的颜色为蓝色，male分流的颜色为红色，蓝色分流出去的宽度和等于female的总宽度。

- 特殊参数

  丝带颜色列：设置需要分流颜色的类型

## 韦恩图

- 简介

  维恩图是一种表示不同有限集合之间所有可能的逻辑关系的图。这些图将集合内元素描述为平面上的点，将集合描述为封闭曲线内的区域。维恩图由多个重叠的闭合曲线(通常是圆)组成，每个曲线代表一个集合。标记为S曲线内的点表示集合S中的元素，而边界外的点表示集合S中不存在的元素。例如，两个集合中的所有元素的交集，S∩T，在视觉上用集合S和T的重叠区域来表示。在维恩图中，曲线以各种可能的方式重叠，显示了集合之间所有可能的关系。

- 案例数据分析

  载入数据为5个含有基因名称的集合。

- 案例统计图形解读

  5种颜色的闭合曲线代表5个集合，数字表示多个集合重叠或者未重叠的基因数，例如：示例图中8代表5个示例集合中均含有8个相同的基因名称。

## t-SNE

- 简介

  t-SNE是一种非线性降维算法，适用于高维数据降维到2维或3维并进行可视化。该算法能够使较大相似度的点，t分布在低维空间中的距离更近；而对于低相似度的点，t分布在低维空间中的距离更远。

- 案例数据分析

  载入数据为数据集（基因名称及其对应的基因表达值）和样本信息（样本名称及分组）

- 案例统计图形解读

  不同颜色表示不同样本，与PCA（主成分分析）图形解释相同，不同之处在于可视化效果，t-SNE中对于不相似的点，用一个较小的距离会产生较大的梯度来让这些点排斥开来。

- **特殊参数**

  **Perplexity:**

  **水平旋转角度：**

## 主成分分析

- 简介

  主成分分析是以“降维"\*" 为核心，用较少的几个综合指标（主成分）代替多指标的数据，还原数据最本质特征的数据处理方式。

- 案例数据分析

  载入数据为数据集（基因名称及其对应的基因表达值）和样本信息（样本名称及分组）

- 案例统计图形解读

  不同颜色表示不同样本，可解读主成分与原变量的关系，如：M1对PC1具有较大的贡献，而M8与PC1呈较大的负相关性。

## 线性回归

- 简介

  线性回归是一种对自变量和因变量之间关系进行线性建模的回归方法。只有一个自变量的情况称为简单回归,大于一个自变量情况的叫做多元回归。

- 案例数据分析

  载入数据为自变量，因变量和分组

- 案例统计图形解读

  不同颜色表示不同分组，可添加线性回归方程，R的平方越接近1，说明拟合的曲线和实际曲线越趋近。灰色条带代表95%置信区间。

- 特殊参数

  添加线性回归方程：添加拟合直线的回归方程和R的平方。

## 线性回归（误差线）

- 简介

  误差线主要指示数据每一个数据点的误差范围，显示潜在的误差或相对于系列中每一个数据的的不确定程度。

- 案例数据分析

  载入数据为两种分组及其对应的数值。

- 案例统计图形分析

  low类型中的红色上线表示treat1中low类型中数值最大值，红色下线表示treat1中low类型中数值最小值，其他以此类推。分别对treat1和treat2按照low，mid，high类型进行秩和检验，显示p值于图形上方。

- 特殊参数

  p值展示形式：value表示数值，signif表示"\*" 的数量，no表示不展示p值

## 散点图

- 简介

  用两组数据构成多个坐标点，通过观察坐标点的分布，判断变量间是否存在关联或总结坐标点分布模式的数据处理方式。

- 案例数据分析

  载入数据为横轴数值及其对应的纵轴数值和分组。

- 案例统计图形分析

  Value1 表示横轴，Value2 表示纵轴，图示表示治疗方案一中 Value1 与 Value2两个变量呈正相关： 即 Value1 变大时， Value2 随之变大； 治疗方案二中两个变量则呈负相关： 即 Value1变大时，Value2 随之变小。

- 特殊参数

  改变点形状：不同分组有不同点的形状

## 3D 散点图

- 简介

  3D散点图是将多个定量变量运用于空间中的不同轴上，并将不同的变量组合成空间中的坐标，从而对三个定量变量的交互关系进行清晰的解释。

- 案例数据分析

  载入数据为三个变量和分组。

- 案例统计图形分析

  图中分别将温度、压力、时间放置在x（水平轴）、y（垂直轴）、z（透视轴）上，生成一幅三维散点图，直观发现三者变量间的相关关系及相关强弱程度。

- 特殊参数

  俯仰角：正值越大，表示趋于从三维图形顶端向下观测；负值越大，表示趋于从三维图形底端向上观测。

  水平旋转角度：三维图形水平旋转的角度

## 直方图

- 简介

  直方图是由一系列高度不等的纵向条纹或线段表示连续性变量数据的分布情况。

- 案例数据分析

  载入数据为数据集(不同治疗方案治疗效果数据)。

- 案例统计图形分析

  图中长方形的宽度与组距成正比且可不相同，纵轴代表频数。

- 特殊参数

  Bins:更改矩形的宽度

## 密度图

- 简介

  核密度图是一种用来观察连续型变量分布的图形。

- 案例数据分析

  载入数据为数据集(不同治疗方案治疗效果数据)。

- 案例统计图形分析

  不同颜色表示不同分组，横轴表示数值，纵轴表示频率。

- 特殊参数

  **堆积图形：**

## 饼图

- 简介

  饼图是通过将一个圆形切分成多个切片以显示每一部分所占总体比例的统计图表。

- 案例数据分析

  载入数据为不同分组及其数据。

- 案例统计图形分析

  在一个圆图中，每个切片的弧长（其中心角和中心角所对应区域的弧长）与所表示的数量成正比。该饼图展示了1~4组分别的样本数量及样本数量所对应的占比。一组样本数量13，占比11.71%，二组样本数量34，占比30.63%，三组样本数量21，占比18.92%，四组样本数量43，占比38.74%。

## 环形图

- 简介

  环形图是饼图的一种变体，它有一个允许包含数据整体额外信息的空白中心。且与饼图目的一致，都是用来说明数据比例。

- 案例数据分析

  载入数据为不同分组及其数据。

- 案例统计图形解读

  不同颜色表示不同组群 ，不同面积表示数据及占比。

## 系统树图

- 简介

  系统树图是一种以树的形状表示的图。这种图表在不同情景有不同的含义。如：在层次聚类中，说明了相应分析产生的聚类的排列。在生物信息中，它显示基因或样本的聚集，有时在热图的边缘。

- 案例数据分析

  载入数据为基因名称及其对应的基因表达值。

- 案例统计图形解读

  该图如同垂直90°的树，M1-M10表示树根，树枝向右生长聚合，形成树枝树干。可以看出，该图先后生成2类，4类，以此类推。

- 特殊参数

  **分支数：**

  **距离计算方法：更改计算树距离的方法**

  树的外形：更改树的形状

  添加标签颜色：聚类后使样本相近的样本名称颜色相近

## 丝带图

- 简介

  丝带图是一种类似丝带的图形。

- 案例数据分析

  载入数据为x轴数值及其对应的两个y轴数值和分组。

- 案例统计图形分析

  每种颜色表示不同的分组，可以透过其中折线，观测每组数据随时间的变化。

## 蜜蜂群图

- 简介

  蜜蜂群图是一种类似蜜蜂群，样本间互不干涉的列散点图。

- 案例数据分析

  载入数据为不同分组及其数据。

- 案例统计图形解读

  不同颜色表示不同组群 ，点表示数据。

## 面积图

- 简介

  面积图是一种基于折线图并以图形方式显示定量数据的图形。轴和线之间的区域通常用颜色、纹理和图案来强调。

- 案例数据分析

  载入数据为x轴数值和y轴数值。

- 案例统计图形解读

  不同颜色代表不同组的面积图。

## 柱状图

- 简介

  柱状图是一种以长方形的长度表示数据值大小的统计图表。

- 案例数据分析

  载入数据为不同治疗方案中不同剂量药物作用效果数据。

- 案例统计图形解读

  条形图用于显示带有矩形条的类别数据， 矩形条的高度或长度与它们所代表的值成比例。条形图可以垂直或水平绘制。条形图显示了离散类别之间的比较。 图表的一个轴显示要比较的特定类别，另一个轴代表测量值。 一些条形图显示的条形也可显示多个测量变量的值。该条形图展示了不同治疗组（组 1~组 4）分别用低、中、高剂量进行治疗时，不同的治疗效果。组 1 使用中剂量治疗时效果最好，组 2 使用高剂量治疗时效果最好，组3使用剂量治疗时无较大差距，组 4 使用高剂量治疗时效果最好。

- 特殊参数

  叠加类型：dodge表示横向罗列，stack表示上下叠加

  水平：互换类别轴与测量值轴的位置

  添加数字标签：标注数值

## 等高线图（矩阵）

- 简介

  等高图（矩阵）是一种以二维形式展示三维数据的图形。

- 案例数据分析

  载入数据为一个矩阵。

- 案例统计图形分析

  黄色代表最高，深紫色代表最低，高度刻度范围是90-190。

## 3D饼图

- 简介

  3D饼图是指具有3D外观的饼图。

- 案例数据分析

  载入数据为不同分组及其数据。

- 案例统计图形分析

  该图通过3D形式，更美观的展示了1~4组的样本数量及样本数量所对应的占比。一组样本数量13，占比11.71%，二组样本数量34，占比30.63%，三组样本数量21，占比18.92%，四组样本数量43，占比38.74%。

- 特殊参数

  直径：圆盘的直径

  厚度：圆盘的厚度

  水平旋转角度：3D饼图水平旋转的角度

  离散度：各分组扇形图的离散程度

## 线图

- 简介

  线图是指使用线性刻度或对数刻度在二维或三维视图中绘制数据，从而显示数据集或跟踪数据随时间变化的变化特征的统计图表。

- 案例数据分析

  载入数据为横轴数值及其对应的纵轴数值和分组。

- 案例统计图形分析

  图示表明治疗方案一中value1值与value2值呈正相关，而治疗方案二value1值与value2值呈负相关。

- 特殊参数

  改变线形：改变不同分组线的形态

  添加散点：添加数值对应的点

## 气泡图

- 简介

  气泡图是在散点图的基础上，用气泡的大小来展示第三个变量,从而能够同时对三个变量进行对比分析的统计图表。

- 案例数据分析

  **载入数据为GO Term,Gene Ridio,基因数和p-value值。**

- 案例统计图形分析

  x轴表示Gene Ridio，y轴是GO Term;点的大小表示基因数，点的颜色代表p值的高低。

- 特殊参数

  展示数目：显示气泡的数量

  颜色主题：显示p值的颜色主题

## 滑珠图

- 简介

  滑珠图是一种珠子在柱上滑行的图形，是条形图与散点图的叠加。

- 案例数据分析

  载入数据为基因名称及其对应的基因表达值和分组。

- 案例统计图形分析

  每种颜色表示不同的分组，能够直观了解不同基因表达值的差异。

## 3D柱状图

- 简介

  3D柱状图用于为数据提供3D外观。 第三维通常出于美学原因而使用，但其不能改善数据的读取。 仍旨在显示离散类别之间的比较。

- 案例数据分析

  载入数据为不同治疗方案中不同剂量药物作用效果数据。

- 案例统计图形解读

  该3D柱状图展示了不同治疗组（组1~组4）分别用低、中、高剂量进行治疗时，不同的治疗效果。组1使用中剂量治疗时效果最好，组2使用高剂量治疗时效果最好，组3使用剂量治疗时无较大差距，组4使用高剂量治疗时效果最好。

- 特殊参数

  俯仰角：正值越大，表示趋于从三维图形顶端向下观测；负值越大，表示趋于从三维图形底端向上观测。

  水平旋转角度：三维图形水平旋转的角度。

## 等高线图 (XY)

- 简介

  等高线图(XY)是一种通过等高线反映数据密集程度的数据处理方式。

- 案例数据分析

  载入数据为两个变量

- 案例统计图形分析

  正如地理上的等高线代表不同高度一样，等高线图上的不同等高线代表不同密度，越靠中心，等高线圈越小，代表其区域数据密度程度越高。如:黄色区域数据密集程度最高，而蓝色区域数据密集程度最低。

## 雷达图

- 简介

  雷达图是以从同一点开始的轴上表示的三个或更多个定量变量的二维图表的形式显示多变量数据，以直观的表达某个研究对象在多种参数的对比。

- 案例数据分析

  数据载入为数据集(4种疾病中5个基因的表达水平)。

- 案例统计图形分析

  雷达图每种颜色表示一种疾病，每个点所在的位置表示不同基因表达情况，基因表达值越高，则越远离圆心，反之则越靠近圆心。

## 议会图

- 简介

  议会图是一种形似议会坐席，以点代表一个数据，从而更加灵活地展示各组所占份额比的数据处理方式。

- 案例数据分析

  数据载入为分组及其对应数值。

- 案例统计图形分析

  不同颜色表示不同分组，每一个点代表一个数据。它是由很多点组成半环形，最小的份额在议会图里可以用一个点来表示。

## 三维透视图

- 简介

  三维透视图是一种能将一个矩阵中包含的高等数值用曲面连接起来的三维立体图形。

- 案例数据分析

  载入数据为一个矩阵。

- 案例统计图形分析

  清晰观测一个山峰的全貌。

## 树形图

- 简介

  树形图是一种用图形形式来表示层次结构的树形结构图。

- 案例数据分析

  载入数据为不同分组及其数据。

- 案例统计图形解读

  不同颜色表示不同组群 ，不同面积表示数据及占比。

- 特殊参数

  将标签的大小和方框大小关联：将标签的大小与方框大小比例相关联。

## 扇形图

- 简介

  扇形图是旨在以所占扇形的大小清楚表示各组数据所占百分比的统计图表。

- 案例数据分析

  载入数据为不同分组及其数据。

- 案例统计图形解读

  不同颜色表示不同组群 ，不同面积表示数据及占比。

- 特殊参数

  显示占比：在不同分组旁显示其占比

## 中国地图

- 简介

  中国地图是指在中国地图上展示一组变量在中国境内不同省份的分布情况的统计图表。

- 案例数据分析

  载入数据为中国各省份某变量的分布情况。

- 案例统计图形解读

  图示说明了变量数值在中国境内不同省份的分布情况。颜色越红，则数值越高，颜色越接近于绿，则数值越低。

## 世界地图

- 简介

  世界地图是指在世界地图上展示一组变量在世界不同国家的分布情况的统计图表。

- 案例数据分析

  载入数据为世界各国某变量的分布情况。

- 案例统计图形解读

  图示说明了变量数值在世界不同国家的分布情况。颜色越红，则数值越高，颜色越接近于绿，则数值越低。

